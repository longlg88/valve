# Valve

## Valve 란?
Valve는 [BespinGlobal](https://www.bespinglobal.com/)의 Cloud Managment Platform(CMP) 서비스인 [OpsNow](https://www.opsnow.com/)의 개발/운영 환경을 자동화하는 과정에서 만들어진 코드 산출물을 공개하면서 시작된 프로젝트입니다.

초기에 밸브로 명명되지 않고 다음과 같은 요구 사항을 수용하는 코드 조각들 이었습니다.
* VM으로 운영되던 서비스를 컨테이너로 이관
* 개발/운영 환경을 쿠버네티스 기반으로 운영
* 전체 영역을 수용하는 오픈소스의 DevOps 툴 체인 구성
* 댜양한 유형의 애플리케이션을 배포하기 위한 유연한 CI/CD 파이프라인
* 인프라를 코드로 구성하는 IaC
* GitOps 도입

차츰 이들 코드 조각들이 쌓이면서 밸브라는 이름을 갖게 되었습니다. 이러한 이유로 밸브는 특화된 솔루션의 형태를 갖추고 있지 않습니다. 클라우드 환경에서 개발, 운영되는 애플리케이션의 인프라부터 애플리케이션 전반에 걸친 자동화를 위한 코드의 집합으로 인식할 수 있습니다.

## Valve 프로젝트의 목표
특별한 목표를 갖고 있지 않기 때문에 밸브의 명확한 로드맵을 제시할 수 없지만 다음과 같은 지향점을 갖는 코드 조각이면 밸브의 프로젝트가 될 수 있습니다.
* Multi Public Cloud(AWS, Azure, GCP), Hybrid(Openstack, VMware) 쿠버네티스 인프라
  * 상용 서비스가 운영 가능한 Kubernetes 클러스터 구성 인프라 코드
* DevOps 툴체인
  * 오픈소스 선호
  * CI/CD 툴간 연계 방법 제공
  * 최소의 인증 방식 또는 네트워크 접근 제어 코드를 포함 필수
* 인프라 빌드, 배포 템플릿
  * Well-defined Architecture를 정의한 인프라 코드 템플릿
  * 인프라 코드 템플릿을 배포, 운영하기 위한 파이프라인 코드 템플릿
* 애플리케이션 빌드, 배포 템플릿
  * 배포 타깃(컨테이너, VM, Serverless)별 배포 형상을 정의한 코드 템플릿
  * 배포 타깃(컨테이너, VM, Serverless), 소스 코드 유형별 빌드/배포 파이프라인을 코드 템플릿
* CI/CD 파이프라인 모듈
* 툴 체인 연결 및 운영을 위한 코드

## Valve 프로젝트 사용자
사용자가 밸브를 통해 인프라를 구성하고 애플리케이션을 배포하려면 사용하려는 의도에 따라 다양한 기술적인 이해가 필요합니다.
* 쿠버네티스 클러스터 생성
  * 테라폼 코드
    * 기본 코드를 사용할 경우 수정없이 사용 가능하지만 일반적으로 설치 환경에 맞는 조건을 입력하고, 일부 배포 리소스를 조정할 수 있어야 합니다. 이를 위해 테라폼 코드에 대한 이해가 필요합니다.
  * 클라우드 서비스
    * 테라폼 코드를 통해 생성되는 자원은 클라우드가 제공하는 자원들의 집합입니다. 운영을 위해서는 이렇게 생성된 리소스에 대해 충분한 이해가 필요합니다.
    * 쿠버네티스 클러스터와 애플리케이션을 운영할 수 있어야 합니다.
* DevOps 툴 체인 구성
  * 개별 툴의 운영 방법
    * 각 각의 툴은 툴 나름대로의 복잡한 설정과 운영 노하우를 필요로 합니다. 예를 들어 젠킨스 운영을 위해서는 최초 구동 조건 설정 방법, 사용자 인증 방법, 권한 부여 방법, 스토리지 관리 방법, 인증 코드 관리 방법 등의 다양한 운영 노하우가 요구 됩니다.
* 애플리케이션 개발
  * 밸브는 애플리케이션 개발자를 위해 프로젝트 유형별 템플릿을 제공하고 있습니다. 컨테이너 배포를 위한 템플릿은 Jenkinsfile, Dockerfile, Helm chart 등으로 구성되어 있습니다. 개발자는 애플리케이션 빌드, 배포 조건을 수정하기 위해서 이를 파일에 대한 이해가 필요할 수 있습니다.

밸브를 개발자의 입장에서 사용한다면 밸브 인프라, 툴 체인 운영 방법에 대해 깊이 알고있어야 할 필요가 없겠지만 인프라 및 툴체인을 운영하는 사람은 좀 더 깊은 이해와 사용 노하우가 필요합니다.

기본적으로 밸브를 운영하는 조직은 DevOps팀 또는 SRE팀이 되는 것이 좋습니다.
사이트별로 툴 체인에 대한 요구 사항이 다르고 인증 방식, 네트워크 구성, 인프라 구성 등이 다르기 때문에 이를 코드로 변경하고 관리할 수 있는 능력을 갖추고 있어야 하기 때문입니다.

## Valve 하위 프로젝트
현재 valve는 다음과 같은 프로젝트로 구성되어 있습니다.

* 쿠버네티스 클러스터 생성을 위한 프로젝트
  * [valve-kops](https://github.com/opsnow-tools/valve-kops)
    * kops는 AWS EC2에 쿠버네티스 클러스터를 구성하는 도구 입니다. valve-kops는 kops CLI를 사용해 만들어진 CUI 도구로 문답 형태로 쿠버네티스 클러스터를 생성하고 관리하는 도구입니다. EKS를 사용할 수 없는 리젼이나 쿠버네티스 마스터 노드의 설정을 직접 관리하고 싶은 경우 사용하는 도구 입니다.
  * [valve-eks](https://github.com/opsnow-tools/valve-eks)
    * valve-eks는 테라폼 코드를 사용해 AWS eks환경을 구성하는 쿠버네티스 클러스터를 생성하는 도구입니다. 쿠버네티스 클러스터를 운영하기 위해서는 EKS 외에도 네트워크, 스토리지 등의 인프라를 구성해야 합니다. valve-eks는 EKS 뿐만아니라 운영에 필요한 주변 인프라의 생성까지 테라폼 모듈로 제공합니다.
* DevOps 툴 체인 구성을 위한 프로젝트
  * [valve-tools](https://github.com/opsnow-tools/valve-tools)
    * valve-tools는 DevOps 툴 체인을 구성하기 위한 CUI 도구 입니다. valve-tools를 사용해서 DevOps 팀은 쿠버네티스 환경에 툴 체인을 빠르게 구성하고 이를 통해 애플리케이션을 빌드하고 배포할 수 있는 파이프라인을 갖을 수 있습니다. 또한 애플리케이션의 모니터링, 알람, 통합 로깅을 위한 도구도 구성할 수 있습니다. 
* CI/CD 파이프라인
  * [valve-butler](https://github.com/opsnow-tools/valve-butler)
    * TBD
  * [valve-builder](https://github.com/opsnow-tools/valve-builder)
    * TBD
* 개발자 도구
  * [valve-ctl](https://github.com/opsnow-tools/valve-ctl)
    * TBD

## Valve 프로젝트 시작하기 

* [밸브를 통한 애플리케이션 배포 빠르게 시작하기](./hands-on/valve-ctl-30min-quickstart.md)
* [1시간 밸브 패스트트랙](./hands-on/valve-fast-track.md)

## 라이선스 정보

TBD